# å—æ„ç§‹æ£ åŸŸåè®¿é—®é…ç½®è¯´æ˜

## ğŸŒ åŸŸåè®¿é—®åœ°å€

### å‰ç«¯è®¿é—®
- **åŸŸåè®¿é—®**: http://chenxiaoshivivid.com.cn:8500
- **IPè®¿é—®**: http://121.36.205.70:8500

### åç«¯APIè®¿é—®
- **åŸŸåè®¿é—®**: http://chenxiaoshivivid.com.cn:5001
- **IPè®¿é—®**: http://121.36.205.70:5001

## ğŸ”§ é…ç½®ä¿®æ”¹

### 1. å‰ç«¯æœåŠ¡å™¨é…ç½® (`frontend/server.py`)
```python
# é»˜è®¤åŸŸåé…ç½®
domain = os.environ.get('DOMAIN', 'chenxiaoshivivid.com.cn')
backend_url = os.environ.get('BACKEND_URL', 'http://121.36.205.70:5001')
```

### 2. åç«¯æœåŠ¡å™¨é…ç½® (`backend/app.py`)
```python
# é»˜è®¤åŸŸåé…ç½®
domain = os.environ.get('DOMAIN', 'chenxiaoshivivid.com.cn')
```

## ğŸš¨ ç«¯å£å ç”¨é—®é¢˜è§£å†³

### é—®é¢˜ç°è±¡
- ç³»ç»ŸæœåŠ¡ä¸æ–­é‡å¯
- é”™è¯¯ä¿¡æ¯ï¼š`OSError: [Errno 98] Address already in use`

### è§£å†³æ–¹æ¡ˆ

#### 1. ä½¿ç”¨å¼ºåˆ¶æ¸…ç†è„šæœ¬
```bash
cd /opt/hanfu/products
sudo bash force-cleanup.sh
```

#### 2. é‡æ–°å®‰è£…ç³»ç»ŸæœåŠ¡
```bash
# å¸è½½æ—§æœåŠ¡
sudo bash service-manager.sh uninstall

# é‡æ–°å®‰è£…æœåŠ¡
sudo bash service-manager.sh install
```

#### 3. æ‰‹åŠ¨å¯åŠ¨æœåŠ¡
```bash
# å¦‚æœç³»ç»ŸæœåŠ¡æœ‰é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ‰‹åŠ¨å¯åŠ¨
./start_services.sh
```

## ğŸ” æ•…éšœæ’é™¤

### æ£€æŸ¥ç«¯å£å ç”¨
```bash
# æ£€æŸ¥5001ç«¯å£
lsof -i :5001

# æ£€æŸ¥8500ç«¯å£
lsof -i :8500

# æ£€æŸ¥æ‰€æœ‰ç›¸å…³è¿›ç¨‹
ps aux | grep python
```

### å¼ºåˆ¶æ¸…ç†ç«¯å£
```bash
# æ€æ­»å ç”¨5001ç«¯å£çš„è¿›ç¨‹
lsof -ti:5001 | xargs kill -9

# æ€æ­»å ç”¨8500ç«¯å£çš„è¿›ç¨‹
lsof -ti:8500 | xargs kill -9

# æ€æ­»æ‰€æœ‰ç›¸å…³Pythonè¿›ç¨‹
pkill -f "python.*app.py"
pkill -f "python.*server.py"
```

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
# æŸ¥çœ‹ç³»ç»ŸæœåŠ¡çŠ¶æ€
systemctl status nanyi-backend nanyi-frontend

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl -u nanyi-backend -f
journalctl -u nanyi-frontend -f
```

## ğŸŒŸ DNSé…ç½®å»ºè®®

### å¦‚æœåŸŸåè§£ææœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. **DNSè®°å½•é…ç½®**
   ```
   Aè®°å½•: chenxiaoshivivid.com.cn -> 121.36.205.70
   ```

2. **é˜²ç«å¢™è®¾ç½®**
   ```bash
   # å¼€æ”¾ç«¯å£
   firewall-cmd --permanent --add-port=5001/tcp
   firewall-cmd --permanent --add-port=8500/tcp
   firewall-cmd --reload
   ```

3. **å®‰å…¨ç»„é…ç½®**
   - ç¡®ä¿äº‘æœåŠ¡å™¨å®‰å…¨ç»„å¼€æ”¾äº†5001å’Œ8500ç«¯å£

## ğŸ“± è®¿é—®æµ‹è¯•

### æµ‹è¯•æ­¥éª¤
1. ç¡®ä¿æœåŠ¡æ­£å¸¸è¿è¡Œ
2. åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼šhttp://chenxiaoshivivid.com.cn:8500
3. å¦‚æœåŸŸåè®¿é—®å¤±è´¥ï¼Œå°è¯•IPè®¿é—®ï¼šhttp://121.36.205.70:8500

### é¢„æœŸç»“æœ
- é¡µé¢æ­£å¸¸åŠ è½½
- å¯ä»¥çœ‹åˆ°æ±‰æœå¸ƒæ–™è®¾è®¡å±•ç¤º
- ç­›é€‰å’Œæœç´¢åŠŸèƒ½æ­£å¸¸
- å›¾ç‰‡é¢„è§ˆå’Œä¸‹è½½åŠŸèƒ½æ­£å¸¸

## ğŸ¯ æ¨èéƒ¨ç½²æ–¹å¼

### ç”Ÿäº§ç¯å¢ƒæ¨è
```bash
# 1. å¼ºåˆ¶æ¸…ç†
sudo bash force-cleanup.sh

# 2. å®‰è£…ç³»ç»ŸæœåŠ¡
sudo bash install-service.sh

# 3. éªŒè¯æœåŠ¡çŠ¶æ€
systemctl status nanyi-backend nanyi-frontend
```

### å¼€å‘ç¯å¢ƒæ¨è
```bash
# ä½¿ç”¨æ‰‹åŠ¨å¯åŠ¨ï¼Œä¾¿äºè°ƒè¯•
./start_services.sh
```

---

**æ›´æ–°æ—¶é—´**: 2024å¹´6æœˆ8æ—¥  
**é…ç½®çŠ¶æ€**: âœ… å·²å®ŒæˆåŸŸåè®¿é—®é…ç½® 